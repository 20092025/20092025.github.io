<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëã±ËØ≠Â≠¶‰π†ÊØèÊó•Êô∫ËÉΩÂ•ñÂä±Ê∏ÖÂçï - Êï∞ÊçÆÁÆ°ÁêÜÁâà</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìö</text></svg>">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <style>
        :root {
            --primary-color: #4b6cb7;
            --secondary-color: #182848;
            --accent-color: #28a745;
            --light-bg: #f8f9fa;
            --card-bg: #ffffff;
            --text-dark: #333333;
            --text-light: #6c757d;
            --sync-color: #d4d4aa; /* ÂêåÊ≠•ÊåâÈíÆÈ¢úËâ≤Ë∞ÉÊöó */
            --danger-color: #dc3545;
            --countdown-color: #ff6b35; /* ÂÄíËÆ°Êó∂È¢úËâ≤Êõ¥ÈÜíÁõÆ */
            --safe-area-inset-top: env(safe-area-inset-top);
            --safe-area-inset-bottom: env(safe-area-inset-bottom);
        }
        
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            padding-top: calc(20px + var(--safe-area-inset-top));
            padding-bottom: calc(20px + var(--safe-area-inset-bottom));
            background-color: var(--light-bg);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            position: relative;
        }
        
        .sync-status {
            position: absolute;
            top: 15px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .sync-icon {
            animation: spin 2s linear infinite;
            display: none;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .countdown {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 18px;
            border-radius: 20px;
            font-size: 16px; /* Â¢ûÂ§ßÂ≠ó‰Ωì */
            font-weight: bold; /* Âä†Á≤ó */
            backdrop-filter: blur(5px);
            color: var(--countdown-color); /* ‰ΩøÁî®ÈÜíÁõÆÈ¢úËâ≤ */
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            animation: pulse 2s infinite; /* Ê∑ªÂä†ËÑâÂä®Âä®Áîª */
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .nav-tabs {
            display: flex;
            margin-bottom: 20px;
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            -webkit-overflow-scrolling: touch;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .nav-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            min-width: 120px;
        }
        
        .nav-tab.active {
            border-bottom: 3px solid var(--primary-color);
            font-weight: 600;
            background-color: rgba(75, 108, 183, 0.1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .card {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }
        
        .progress-container {
            text-align: center;
        }
        
        .progress-bar {
            height: 28px;
            background-color: #e9ecef;
            border-radius: 6px;
            margin: 15px 0;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            border-radius: 6px;
            transition: width 0.7s ease;
            width: 0%;
        }
        
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: var(--card-bg);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        th, td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            word-break: break-word;
        }
        
        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background-color: rgba(75, 108, 183, 0.05);
        }
        
        .points {
            font-weight: bold;
            color: var(--accent-color);
            text-align: center;
        }
        
        .category {
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .checkbox {
            width: 28px;
            height: 28px;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
            background-color: #fff;
            border: 2px solid #ccc;
            border-radius: 4px;
            display: inline-block;
            position: relative;
            margin: 0;
            vertical-align: middle;
        }
        
        .checkbox:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .checkbox:checked::after {
            content: "‚úì";
            position: absolute;
            color: white;
            font-size: 18px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .data-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .btn {
            padding: 14px 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
            touch-action: manipulation;
            min-height: 44px;
        }
        
        .btn:hover, .btn:active {
            background-color: var(--secondary-color);
        }
        
        .btn-sync {
            background-color: var(--sync-color);
            color: #333;
        }
        
        .btn-sync:hover {
            background-color: #c0c090;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
        }
        
        .btn-danger:hover {
            background-color: #bb2d3b;
        }
        
        .btn-small {
            padding: 8px 12px;
            font-size: 14px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 8px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
        }
        
        .save-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--accent-color);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }
        
        .sync-settings {
            background-color: #f0f7ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .data-records {
            margin-top: 30px;
        }
        
        .record-actions {
            display: flex;
            gap: 8px;
            justify-content: center;
        }
        
        .search-filter {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .search-filter input {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* ÁßªÂä®ËÆæÂ§á‰ºòÂåñ */
        @media (max-width: 768px) {
            body {
                padding: 15px;
                padding-top: calc(15px + var(--safe-area-inset-top));
                padding-bottom: calc(15px + var(--safe-area-inset-bottom));
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .countdown, .sync-status {
                position: static;
                margin-top: 10px;
                display: inline-block;
            }
            
            .data-form {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: row;
                overflow-x: auto;
            }
            
            .nav-tab {
                min-width: 100px;
                padding: 12px 10px;
                font-size: 14px;
            }
            
            table {
                font-size: 14px;
            }
            
            th, td {
                padding: 12px 8px;
            }
            
            .btn {
                padding: 12px 20px;
                width: 100%;
            }
            
            .card {
                padding: 15px;
            }
            
            .record-actions {
                flex-direction: column;
            }
            
            .btn-small {
                width: 100%;
            }
        }
        
        /* Âπ≥ÊùøËÆæÂ§á‰ºòÂåñ */
        @media (min-width: 769px) and (max-width: 1024px) {
            body {
                padding: 20px;
            }
            
            .nav-tab {
                min-width: 110px;
                padding: 14px 10px;
            }
        }
        
        /* Èò≤Ê≠¢iOSÁº©Êîæ */
        input, select, textarea {
            font-size: 16px !important;
        }
        
        /* Èò≤Ê≠¢iOSÁÇπÂáªÈ´òÂÖâ */
        * {
            -webkit-tap-highlight-color: transparent;
        }

        /* ÁªüËÆ°Ê†áÁ≠æÈ°µÊ†∑Âºè */
        .stats-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .stats-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 600;
        }
        
        .stats-tab.active {
            border-bottom: 3px solid var(--primary-color);
            color: var(--primary-color);
        }
        
        .stats-content {
            display: none;
        }
        
        .stats-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .stats-summary {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .stat-chart {
            height: 200px;
            background-color: #f8f9fa;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .chart-bar {
            width: 30px;
            background-color: var(--primary-color);
            margin: 0 5px;
            border-radius: 4px 4px 0 0;
            position: relative;
            min-height: 10px;
        }
        
        .chart-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Ëã±ËØ≠Â≠¶‰π†Êô∫ËÉΩÂ•ñÂä±Á≥ªÁªü</h1>
        <p>Âü∫‰∫éÂº∫ÂåñÂ≠¶‰π†ÊñπÊ≥ïÁöÑ84Êó•CET-4Âà∞CET-6ÊèêÂçáËÆ°Âàí</p>
        <div class="sync-status">
            <span class="sync-icon">üîÑ</span>
            <span id="sync-status-text">Êú™ÂêåÊ≠•</span>
        </div>
        <div class="countdown" id="exam-countdown">
            Ë∑ùÁ¶ªËÄÉËØïËøòÊúâ: <span id="countdown-days" style="font-size: 18px;">--</span> Â§©
        </div>
        <div class="date-selector">
            <label for="date">Êó•Êúü: </label>
            <input type="date" id="date" name="date">
            <button class="btn" onclick="updateDate()" style="padding: 10px 15px; margin-left: 10px;">Êõ¥Êñ∞</button>
            <button class="btn btn-sync" onclick="syncData()" style="padding: 10px 15px; margin-left: 10px;">ÂêåÊ≠•Êï∞ÊçÆ</button>
        </div>
    </div>

    <div class="nav-tabs">
        <div class="nav-tab active" onclick="switchTab('daily-tab')">ÊØèÊó•‰ªªÂä°</div>
        <div class="nav-tab" onclick="switchTab('data-tab')">Â≠¶‰π†Êï∞ÊçÆ</div>
        <div class="nav-tab" onclick="switchTab('stats-tab')">Êï∞ÊçÆÁªüËÆ°</div>
        <div class="nav-tab" onclick="switchTab('rewards-tab')">Â•ñÂä±ÂÖëÊç¢</div>
        <div class="nav-tab" onclick="switchTab('sync-tab')">ÂêåÊ≠•ËÆæÁΩÆ</div>
    </div>

    <div id="daily-tab" class="tab-content active">
        <div class="card progress-container">
            <h3>‰ªäÊó•ËøõÂ∫¶ <span id="current-points">0</span>/100 ÂàÜ</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
                <div class="progress-text" id="progress-text">0%</div>
            </div>
            <p>ÁõÆÊ†á: ‚â•80ÂàÜÂèØËé∑Âæó30ÂàÜÈíüÊó†Ë¥üÁΩ™ÊÑüÂ®±‰πêÊó∂Èó¥</p>
        </div>

        <div class="card">
            <h3>ÊØèÊó•Ê†∏ÂøÉ‰ªªÂä°</h3>
            <table>
                <thead>
                    <tr>
                        <th width="8%">ÂÆåÊàê</th>
                        <th width="15%">Á±ªÂà´</th>
                        <th width="32%">Ë°åÂä® (Action)</th>
                        <th width="25%">‰ºòÂåñ‰∏éÈò≤‰ΩúÂºäÊú∫Âà∂</th>
                        <th width="10%">Â•ñÂä±</th>
                        <th width="10%">ÂæóÂàÜ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task1" onclick="updatePoints(15, this)"></td>
                        <td class="category">ËØçÊ±áÊîªÂùö</td>
                        <td>Â≠¶‰π†Âπ∂ÊéåÊè°35‰∏™Êñ∞ÂÖ≠Á∫ßËØçÊ±á/Áü≠ËØ≠</td>
                        <td>ÂøÖÈ°ªËÉΩÊ≠£Á°ÆÊãºÂÜô„ÄÅËØ¥Âá∫‰∏≠ÊñáÊÑèÊÄù„ÄÅÂπ∂ÈÄ†‰∏Ä‰∏™Ê≠£Á°ÆÂè•Â≠ê„ÄÇÊ¨°Êó•Â§ç‰π†Êó∂ËÉΩÂÜçÊ¨°ËÆ§Âá∫ÊâçÁÆóÊï∞„ÄÇ</td>
                        <td class="points">+15</td>
                        <td id="point1">0</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task2" onclick="updatePoints(20, this)"></td>
                        <td class="category">Âê¨ÂäõÊ≤âÊµ∏</td>
                        <td>ÂÆåÊàê1ÁØáÂÖ≠Á∫ßÂê¨ÂäõÁúüÈ¢òÂπ∂Á≤æÂê¨Â§çÁõò</td>
                        <td>Âê¨ÂÜôÂá∫ÈîôÈ¢òÁÇπÁöÑÂÖ≥ÈîÆÂè•ÔºåÂπ∂Ë∑üËØªËá≥ËØ≠Èü≥ËØ≠Ë∞ÉÂü∫Êú¨‰∏ÄËá¥„ÄÇ</td>
                        <td class="points">+20</td>
                        <td id="point2">0</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task3" onclick="updatePoints(25, this)"></td>
                        <td class="category">ÈòÖËØªËß£Êûê</td>
                        <td>ÂÆåÊàê2ÁØáÂÖ≠Á∫ßÈòÖËØªÁúüÈ¢òÂπ∂Á≤æËØªÂàÜÊûê</td>
                        <td>ÊëòÂΩï2‰∏™ÈïøÈöæÂè•ËøõË°åÁªìÊûÑÂàÜÊûêÔºåÂπ∂Êï¥ÁêÜ10‰∏™ÁîüËØç/Áü≠ËØ≠„ÄÇ</td>
                        <td class="points">+25</td>
                        <td id="point3">0</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task4" onclick="updatePoints(20, this)"></td>
                        <td class="category">ÂÜô‰Ωú/ÁøªËØë</td>
                        <td>ÂÆåÊàê1ÁØá‰ΩúÊñáÊàñ2ÊÆµÁøªËØëÁªÉ‰π†</td>
                        <td>ÂøÖÈ°ª‰ΩøÁî®Ëá≥Â∞ë5‰∏™Êú¨Êó•ÊàñÊú¨Âë®Â≠¶‰π†ÁöÑÊñ∞ËØçÊ±áÊàñÈ´òÁ∫ßÂè•Âûã„ÄÇ</td>
                        <td class="points">+20</td>
                        <td id="point4">0</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task5" onclick="updatePoints(20, this)"></td>
                        <td class="category">ÁªºÂêàÊäïÂÖ•</td>
                        <td>ÊØèÊó•È´òÊïàÂ≠¶‰π†Êó∂Èïø ‚â• 2.5Â∞èÊó∂</td>
                        <td>‰ΩøÁî®Áï™ËåÑÈíüËÆ∞ÂΩïÔºåÂøÉ‰∏çÂú®ÁÑâÁöÑÊó∂Èó¥‰∏çËÆ°ÂÖ•„ÄÇ</td>
                        <td class="points">+20</td>
                        <td id="point5">0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card">
            <h3>Â§ñÈÉ®È™åËØÅ‰ªªÂä° (ÊØèÂë®Ëá≥Â∞ëÂÆåÊàê3È°π)</h3>
            <table>
                <thead>
                    <tr>
                        <th width="8%">ÂÆåÊàê</th>
                        <th width="15%">Á±ªÂà´</th>
                        <th width="37%">Ë°åÂä® (Action)</th>
                        <th width="20%">ËØ¥Êòé</th>
                        <th width="10%">Â•ñÂä±</th>
                        <th width="10%">ÂæóÂàÜ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task6" onclick="updatePoints(15, this)"></td>
                        <td class="category">AI‰ΩúÊñáËØÑ‰º∞</td>
                        <td>‰ΩøÁî®Grammarly/ChatGPTËØÑ‰º∞‰∏ÄÁØá‰ΩúÊñá</td>
                        <td>Ê†πÊçÆAIÂèçÈ¶à‰øÆÊîπÂπ∂Êèê‰∫§ÊúÄÁªàÁâà</td>
                        <td class="points">+15</td>
                        <td id="point6">0</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task7" onclick="updatePoints(15, this)"></td>
                        <td class="category">Âè£ËØ≠ÁªÉ‰π†</td>
                        <td>‰ΩøÁî®Ëã±ËØ≠ÈÖçÈü≥APPÊàñAIÂØπËØùÂ∑•ÂÖ∑ÁªÉ‰π†</td>
                        <td>ËÆ∞ÂΩïÂàÜÊï∞Âπ∂ÊØî‰∏äÂë®ÊèêÈ´ò</td>
                        <td class="points">+15</td>
                        <td id="point7">0</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task8" onclick="updatePoints(20, this)"></td>
                        <td class="category">Ê®°ÊãüÊµãËØï</td>
                        <td>ÂÆåÊàê‰∏ÄÂ•óÂÆåÊï¥Ê®°ÊãüÊµãËØï</td>
                        <td>‰∏•Ê†ºËÆ°Êó∂ÔºåËá™ÊàëËØÑÂàÜ</td>
                        <td class="points">+20</td>
                        <td id="point8">0</td>
                    </tr>
                    <tr>
                        <td><input type="checkbox" class="checkbox" id="task9" onclick="updatePoints(30, this)"></td>
                        <td class="category">Â§ñÈÉ®ÊµãËØÑ</td>
                        <td>Âë®Êú´Ê®°ËÄÉ‰∏≠ÂçïÈ°πÊàêÁª©ÊØî‰∏äÂë®ÊúâÊèêÂçá</td>
                        <td>ÈúÄÊúâÁ¨¨‰∏âÊñπÈ™åËØÅÊàñÈÄöËøáÊ†áÂáÜÊµãËØïÁ°ÆËÆ§</td>
                        <td class="points">+30</td>
                        <td id="point9">0</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="data-tab" class="tab-content">
        <div class="card">
            <h3>Â≠¶‰π†Êï∞ÊçÆËÆ∞ÂΩï</h3>
            <p>ËÆ∞ÂΩïËØ¶ÁªÜÂ≠¶‰π†Êï∞ÊçÆ‰ª•‰æøËøõË°åÊ∑±Â∫¶ÂàÜÊûêÂíåÁ≠ñÁï•‰ºòÂåñ</p>
            
            <div class="data-form">
                <div class="form-group">
                    <label for="learning-date">Êó•Êúü</label>
                    <input type="date" id="learning-date">
                </div>
                
                <div class="form-group">
                    <label for="study-time">Â≠¶‰π†Êó∂Èó¥ (ÂàÜÈíü)</label>
                    <input type="number" id="study-time" min="0" max="240">
                </div>
                
                <div class="form-group">
                    <label for="vocab-score">ËØçÊ±áÂæóÂàÜ</label>
                    <input type="number" id="vocab-score" min="0" max="15">
                </div>
                
                <div class="form-group">
                    <label for="listening-score">Âê¨ÂäõÂæóÂàÜ</label>
                    <input type="number" id="listening-score" min="0" max="20">
                </div>
                
                <div class="form-group">
                    <label for="reading-score">ÈòÖËØªÂæóÂàÜ</label>
                    <input type="number" id="reading-score" min="0" max="25">
                </div>
                
                <div class="form-group">
                    <label for="writing-score">ÂÜô‰Ωú/ÁøªËØëÂæóÂàÜ</label>
                    <input type="number" id="writing-score" min="0" max="20">
                </div>
                
                <div class="form-group">
                    <label for="external-score">Â§ñÈÉ®È™åËØÅÂæóÂàÜ</label>
                    <input type="number" id="external-score" min="0" max="30">
                </div>
                
                <div class="form-group">
                    <label for="error-types">‰∏ªË¶ÅÈîôËØØÁ±ªÂûã</label>
                    <select id="error-types">
                        <option value="">--ÈÄâÊã©‰∏ªË¶ÅÈîôËØØ--</option>
                        <option value="vocabulary">ËØçÊ±á‰∏çË∂≥</option>
                        <option value="grammar">ËØ≠Ê≥ïÈîôËØØ</option>
                        <option value="comprehension">ÁêÜËß£ÂÅèÂ∑Æ</option>
                        <option value="time">Êó∂Èó¥‰∏çË∂≥</option>
                        <option value="focus">Ê≥®ÊÑèÂäõ‰∏çÈõÜ‰∏≠</option>
                    </select>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                <button class="btn" onclick="saveLearningData()">‰øùÂ≠òÂ≠¶‰π†Êï∞ÊçÆ</button>
                <button class="btn btn-danger" onclick="clearForm()">Ê∏ÖÁ©∫Ë°®Âçï</button>
            </div>
            
            <div class="data-records">
                <h3 style="margin-bottom: 15px;">Â≠¶‰π†ËÆ∞ÂΩïÂàóË°®</h3>
                
                <div class="search-filter">
                    <input type="text" id="record-search" placeholder="ÊêúÁ¥¢Êó•ÊúüÊàñÈîôËØØÁ±ªÂûã..." oninput="filterRecords()">
                    <button class="btn" onclick="showAllRecords()">ÊòæÁ§∫ÂÖ®ÈÉ®</button>
                </div>
                
                <div id="records-container">
                    <!-- Â≠¶‰π†ËÆ∞ÂΩïÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
        </div>
    </div>

    <div id="stats-tab" class="tab-content">
        <div class="card">
            <h3>Â≠¶‰π†Êï∞ÊçÆÁªüËÆ°</h3>
            <p>Âü∫‰∫éËÆ∞ÂΩïÁöÑÊï∞ÊçÆÁîüÊàêÂ≠¶‰π†Ê¥ûÂØüÔºåÂ∏ÆÂä©‰ºòÂåñÂ≠¶‰π†Á≠ñÁï•</p>
            
            <!-- ÁªüËÆ°Êï∞ÊçÆÂàÜÁ±ªÊ†áÁ≠æÈ°µ -->
            <div class="stats-tabs">
                <div class="stats-tab active" onclick="switchStatsTab('weekly-stats')">Êú¨Âë®ÁªüËÆ°</div>
                <div class="stats-tab" onclick="switchStatsTab('monthly-stats')">Êú¨ÊúàÁªüËÆ°</div>
                <div class="stats-tab" onclick="switchStatsTab('overall-stats')">Êï¥‰ΩìÁªüËÆ°</div>
            </div>
            
            <!-- Êú¨Âë®ÁªüËÆ°ÂÜÖÂÆπ -->
            <div id="weekly-stats" class="stats-content active">
                <div class="stats-summary">
                    <h4>Êú¨Âë®Â≠¶‰π†ÊëòË¶Å</h4>
                    <p>ÁªüËÆ°Âë®Êúü: <span id="weekly-period">-- Ëá≥ --</span></p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>Âπ≥ÂùáÊØèÊó•ÂæóÂàÜ</h4>
                        <div class="stat-value" id="weekly-avg-score">0</div>
                        <p>ÁõÆÊ†á: ‚â•80ÂàÜ</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>ÊúÄÂº∫ËÉΩÂäõÈ°π</h4>
                        <div class="stat-value" id="weekly-strongest">--</div>
                        <p>ÂæóÂàÜÊúÄÈ´òÁöÑÈ¢ÜÂüü</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>ÊúÄÈúÄÊîπËøõÈ°π</h4>
                        <div class="stat-value" id="weekly-weakest">--</div>
                        <p>ÈúÄË¶ÅÂä†Âº∫ÁöÑÈ¢ÜÂüü</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>Âπ≥ÂùáÂ≠¶‰π†Êó∂Èó¥</h4>
                        <div class="stat-value" id="weekly-avg-time">0</div>
                        <p>Âçï‰Ωç: ÂàÜÈíü/Â§©</p>
                    </div>
                </div>
                
                <div class="stat-chart" id="weekly-chart">
                    <!-- Âë®ÁªüËÆ°ÂõæË°®Â∞ÜÈÄöËøáJavaScriptÁîüÊàê -->
                </div>
                
                <div class="stats-summary">
                    <h4>‰∏ªË¶ÅÈîôËØØÂàÜÊûê</h4>
                    <p id="weekly-errors">ÊöÇÊó†Êï∞ÊçÆ</p>
                </div>
            </div>
            
            <!-- Êú¨ÊúàÁªüËÆ°ÂÜÖÂÆπ -->
            <div id="monthly-stats" class="stats-content">
                <div class="stats-summary">
                    <h4>Êú¨ÊúàÂ≠¶‰π†ÊëòË¶Å</h4>
                    <p>ÁªüËÆ°Âë®Êúü: <span id="monthly-period">-- Ëá≥ --</span></p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>Âπ≥ÂùáÊØèÊó•ÂæóÂàÜ</h4>
                        <div class="stat-value" id="monthly-avg-score">0</div>
                        <p>ÁõÆÊ†á: ‚â•80ÂàÜ</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>ÊúÄÂº∫ËÉΩÂäõÈ°π</h4>
                        <div class="stat-value" id="monthly-strongest">--</div>
                        <p>ÂæóÂàÜÊúÄÈ´òÁöÑÈ¢ÜÂüü</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>ÊúÄÈúÄÊîπËøõÈ°π</h4>
                        <div class="stat-value" id="monthly-weakest">--</div>
                        <p>ÈúÄË¶ÅÂä†Âº∫ÁöÑÈ¢ÜÂüü</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>Âπ≥ÂùáÂ≠¶‰π†Êó∂Èó¥</h4>
                        <div class="stat-value" id="monthly-avg-time">0</div>
                        <p>Âçï‰Ωç: ÂàÜÈíü/Â§©</p>
                    </div>
                </div>
                
                <div class="stat-chart" id="monthly-chart">
                    <!-- ÊúàÁªüËÆ°ÂõæË°®Â∞ÜÈÄöËøáJavaScriptÁîüÊàê -->
                </div>
                
                <div class="stats-summary">
                    <h4>‰∏ªË¶ÅÈîôËØØÂàÜÊûê</h4>
                    <p id="monthly-errors">ÊöÇÊó†Êï∞ÊçÆ</p>
                </div>
            </div>
            
            <!-- Êï¥‰ΩìÁªüËÆ°ÂÜÖÂÆπ -->
            <div id="overall-stats" class="stats-content">
                <div class="stats-summary">
                    <h4>Êï¥‰ΩìÂ≠¶‰π†ÊëòË¶Å</h4>
                    <p>ÁªüËÆ°Âë®Êúü: <span id="overall-period">-- Ëá≥ --</span></p>
                    <p>ÊÄªÂ≠¶‰π†Â§©Êï∞: <span id="overall-days">0</span> Â§©</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>Âπ≥ÂùáÊØèÊó•ÂæóÂàÜ</h4>
                        <div class="stat-value" id="overall-avg-score">0</div>
                        <p>ÁõÆÊ†á: ‚â•80ÂàÜ</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>ÊúÄÂº∫ËÉΩÂäõÈ°π</h4>
                        <div class="stat-value" id="overall-strongest">--</div>
                        <p>ÂæóÂàÜÊúÄÈ´òÁöÑÈ¢ÜÂüü</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>ÊúÄÈúÄÊîπËøõÈ°π</h4>
                        <div class="stat-value" id="overall-weakest">--</div>
                        <p>ÈúÄË¶ÅÂä†Âº∫ÁöÑÈ¢ÜÂüü</p>
                    </div>
                    
                    <div class="stat-card">
                        <h4>Â≠¶‰π†ËææÊàêÁéá</h4>
                        <div class="stat-value" id="overall-achievement">0%</div>
                        <p>ËææÂà∞80ÂàÜÁöÑÊØî‰æã</p>
                    </div>
                </div>
                
                <div class="stat-chart" id="overall-chart">
                    <!-- Êï¥‰ΩìÁªüËÆ°ÂõæË°®Â∞ÜÈÄöËøáJavaScriptÁîüÊàê -->
                </div>
                
                <div class="stats-summary">
                    <h4>‰∏ªË¶ÅÈîôËØØÂàÜÊûê</h4>
                    <p id="overall-errors">ÊöÇÊó†Êï∞ÊçÆ</p>
                </div>
            </div>
            
            <button class="btn" onclick="calculateAllStats()" style="margin-top: 20px;">Êõ¥Êñ∞ÁªüËÆ°Êä•Âëä</button>
        </div>
    </div>

    <div id="rewards-tab" class="tab-content">
        <div class="card">
            <h3>Â•ñÂä±ÂÖëÊç¢Êú∫Âà∂</h3>
            <ul>
                <li><strong>ÊØèÊó•ÂÖëÊç¢</strong>: Á¥ØËÆ°ÂæóÂàÜ ‚â• 80ÂàÜÔºåÂç≥ÂèØËé∑Âæó30ÂàÜÈíüÊó†Ë¥üÁΩ™ÊÑüÁöÑÂ®±‰πêÊó∂Èó¥„ÄÇ</li>
                <li><strong>ÊØèÂë®ÂÖëÊç¢</strong>: Êú¨Âë®ÊØèÊó•Âπ≥ÂùáÂàÜ ‚â• 85ÂàÜÔºåÂë®Êú´ÂèØ‰∫´Âèó‰∏ÄÊ¨°"Â§ßÈ§ê"Êàñ"ÁîµÂΩ±"„ÄÇ</li>
                <li><strong>Èò∂ÊÆµÂÖëÊç¢ÔºàÊØè28Â§©Ôºâ</strong>: ÂÆåÊàêÈò∂ÊÆµÁõÆÊ†á‰∏îÊØèÂë®ÂùáÂàÜËææÊ†áÔºåÂÖëÊç¢‰∏ÄÊ¨°‰∏≠ÂûãÂ•ñÂä±ÔºàÂ¶Ç‰π∞‰∏ÄÊú¨ÂñúÊ¨¢ÁöÑ‰π¶„ÄÅÁúã‰∏ÄÂú∫ÊºîÂá∫Ôºâ„ÄÇ</li>
                <li><strong>Â§ñÈÉ®È™åËØÅÂ•ñÂä±</strong>: ÊØèÂë®ÂÆåÊàê3È°πÂ§ñÈÉ®È™åËØÅ‰ªªÂä°ÔºåÈ¢ùÂ§ñÂ•ñÂä±‰∏ÄÊ¨°Â∞èÂûãÂ®±‰πêÊ¥ªÂä®„ÄÇ</li>
                <li><strong>ÁªàÊûÅÂ•ñÂä±</strong>: 84Â§©ÂêéËææÂà∞650ÂàÜÁõÆÊ†áÔºåÂ•ñÂä±Ëá™Â∑±‰∏ÄÊ¨°Ê¢¶ÊÉ≥‰πãÊóÖÊàñÂøÉ‰ª™Â∑≤‰πÖÁöÑÁîµÂ≠ê‰∫ßÂìÅ„ÄÇ</li>
            </ul>
            
            <div style="margin-top: 20px; padding: 15px; background-color: #e8f4f8; border-radius: 8px;">
                <h4>Êú¨Âë®ÂèØÂÖëÊç¢Â•ñÂä±</h4>
                <p id="available-rewards">ÊØèÊó•ÂæóÂàÜËææÂà∞80ÂàÜÂç≥ÂèØËß£ÈîÅÂ•ñÂä±</p>
                <button class="btn" onclick="claimReward()" style="margin-top: 10px;">È¢ÜÂèñÂ•ñÂä±</button>
            </div>
        </div>
    </div>

    <div id="sync-tab" class="tab-content">
        <div class="card">
            <h3>Êï∞ÊçÆÂêåÊ≠•ËÆæÁΩÆ</h3>
            <p>ÈÖçÁΩÆÂêåÊ≠•‰ª•Âú®ÊâÄÊúâËÆæÂ§á‰∏ä‰øùÊåÅÊï∞ÊçÆ‰∏ÄËá¥</p>
            
            <div class="sync-settings">
                <div class="form-group">
                    <label for="user-id">Áî®Êà∑ID</label>
                    <input type="text" id="user-id" placeholder="ËæìÂÖ•ÊÇ®ÁöÑÂîØ‰∏ÄÁî®Êà∑IDÔºàË∑®ËÆæÂ§á‰ΩøÁî®Áõ∏ÂêåIDÔºâ">
                    <small style="color: var(--text-light);">‰ΩøÁî®Áõ∏ÂêåIDÂú®‰∏çÂêåËÆæÂ§á‰∏äÂêåÊ≠•Êï∞ÊçÆ</small>
                </div>
                
                <div class="form-group">
                    <label for="github-token">GitHub ‰∏™‰∫∫ËÆøÈóÆ‰ª§Áâå (ÂèØÈÄâ)</label>
                    <input type="password" id="github-token" placeholder="ËæìÂÖ•ÊÇ®ÁöÑGitHub‰ª§Áâå">
                    <small style="color: var(--text-light);">ÈúÄË¶ÅÂàõÂª∫Â∏¶ÊúâgistÊùÉÈôêÁöÑ‰∏™‰∫∫ËÆøÈóÆ‰ª§Áâå</small>
                </div>
                
                <div class="form-group">
                    <label for="gist-id">Gist ID (ÂèØÈÄâ)</label>
                    <input type="text" id="gist-id" placeholder="ËæìÂÖ•Â≠òÂÇ®Êï∞ÊçÆÁöÑGist ID">
                    <small style="color: var(--text-light);">Â¶ÇÊûúÊ≤°ÊúâÔºåÁÇπÂáª‰∏ãÊñπÊåâÈíÆÂàõÂª∫Êñ∞ÁöÑGist</small>
                </div>
                
                <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                    <button class="btn" onclick="toggleCloudSync()">
                        <span id="sync-toggle-text">ÂêØÁî®‰∫ëÂêåÊ≠•</span>
                    </button>
                    <button class="btn btn-sync" onclick="createNewGist()" style="margin-right: 10px;">ÂàõÂª∫Êñ∞Gist</button>
                    <button class="btn" onclick="saveSyncSettings()">‰øùÂ≠òËÆæÁΩÆ</button>
                </div>
                
                <!-- Êñ∞Â¢ûÔºöÊâãÂä®ÂêåÊ≠•ÂíåÂ§á‰ªΩÂäüËÉΩ -->
                <div style="display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                    <button class="btn btn-sync" onclick="manualSync()">ÊâãÂä®ÂêåÊ≠•</button>
                    <button class="btn" onclick="exportData()">ÂØºÂá∫Êï∞ÊçÆ</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importData(event)">
                    <button class="btn" onclick="document.getElementById('import-file').click()">ÂØºÂÖ•Êï∞ÊçÆ</button>
                </div>
                
                <div style="margin-top: 15px;">
                    <p><strong>‰∫ëÂêåÊ≠•Áä∂ÊÄÅ:</strong> <span id="cloud-sync-status">Êú™ÂêØÁî®</span></p>
                    <p><strong>ÊúÄÂêéÂêåÊ≠•Êó∂Èó¥:</strong> <span id="last-sync-time">‰ªéÊú™ÂêåÊ≠•</span></p>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <h4>ÂêåÊ≠•ÂéÜÂè≤</h4>
                <p id="sync-history">ÊöÇÊó†ÂêåÊ≠•ËÆ∞ÂΩï</p>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Project CET-6-650 | Âü∫‰∫éDeepSeek-R1Âº∫ÂåñÂ≠¶‰π†ÊñπÊ≥ïËÆ∫ | Á¨¨ <span id="day-counter">1</span> Â§©/84Â§©</p>
    </div>

    <div class="save-indicator" id="save-indicator">Êï∞ÊçÆÂ∑≤‰øùÂ≠ò</div>

    <script>
        let totalPoints = 0;
        let learningData = [];
        let weeklyData = {
            startDate: null,
            dailyScores: []
        };
        let syncSettings = {
            userId: '',
            githubToken: '',
            gistId: '',
            cloudSyncEnabled: false
        };
        let syncHistory = [];
        let lastSyncTime = null;
        let currentEditingIndex = -1; // Áî®‰∫éË∑üË∏™ÂΩìÂâçÊ≠£Âú®ÁºñËæëÁöÑËÆ∞ÂΩïÁ¥¢Âºï
        
        // ‰∏∫ÊØè‰∏ÄË°åÊ∑ªÂä†ID‰ª•‰æøËØÜÂà´
        document.addEventListener('DOMContentLoaded', function() {
            const rows = document.querySelectorAll('tbody tr');
            rows.forEach((row, index) => {
                row.id = index + 1;
            });
            
            // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫‰ªäÂ§©
            const today = new Date();
            document.getElementById('date').value = formatDate(today);
            document.getElementById('learning-date').value = formatDate(today);
            
            // ÂàùÂßãÂåñÂÄíËÆ°Êó∂
            updateExamCountdown();
            // ÊØèÂ∞èÊó∂Êõ¥Êñ∞‰∏ÄÊ¨°ÂÄíËÆ°Êó∂
            setInterval(updateExamCountdown, 3600000);
            
            // Âä†ËΩΩ‰øùÂ≠òÁöÑÊï∞ÊçÆ
            loadLocalData();
            loadSyncSettings();
            
            // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊõ¥Êñ∞ÊØèÊó•Êï∞ÊçÆ
            checkAndUpdateDailyData();
            
            // ÊòæÁ§∫Â≠¶‰π†ËÆ∞ÂΩï
            displayLearningRecords();
            
            // Ëá™Âä®ËÆ°ÁÆóÁªüËÆ°Êï∞ÊçÆ
            calculateAllStats();
            
            // Ëá™Âä®ÂêåÊ≠•Êï∞ÊçÆÔºàÂ¶ÇÊûúÂ∑≤ÈÖçÁΩÆÔºâ
            if (syncSettings.cloudSyncEnabled && syncSettings.userId) {
                setTimeout(syncData, 3000);
            }
            
            // ÂÆöÊó∂Ëá™Âä®ÂêåÊ≠•ÔºàÊØè30ÂàÜÈíüÔºâ
            setInterval(() => {
                if (syncSettings.cloudSyncEnabled && syncSettings.userId) {
                    syncData();
                }
            }, 1800000);
        });
        
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        // Ëé∑ÂèñÂåó‰∫¨Êó∂Âå∫ÁöÑÂΩìÂâçÊó•Êúü
        function getBeijingDate() {
            const now = new Date();
            // Âåó‰∫¨Êó∂Èó¥ÊòØUTC+8
            const beijingTime = new Date(now.getTime() + (8 * 60 * 60 * 1000));
            return beijingTime;
        }
        
        // Êõ¥Êñ∞ËÄÉËØïÂÄíËÆ°Êó∂
        function updateExamCountdown() {
            // ËÆæÁΩÆËÄÉËØïÊó•Êúü‰∏∫2025Âπ¥12Êúà13Êó•ÔºàÂèØÊ†πÊçÆÂÆûÈôÖÊÉÖÂÜµ‰øÆÊîπÔºâ
            const examDate = new Date('2025-12-13');
            // ‰ΩøÁî®Âåó‰∫¨Êó∂Âå∫Êó•ÊúüËÆ°ÁÆó
            const today = getBeijingDate();
            
            // ËÆ°ÁÆóÂâ©‰ΩôÂ§©Êï∞
            const timeDiff = examDate.getTime() - today.getTime();
            const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
            
            // Êõ¥Êñ∞ÊòæÁ§∫
            document.getElementById('countdown-days').textContent = daysDiff > 0 ? daysDiff : 0;
        }
        
        // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊõ¥Êñ∞ÊØèÊó•Êï∞ÊçÆ
        function checkAndUpdateDailyData() {
            const lastActivityDate = localStorage.getItem('lastActivityDate');
            const today = formatDate(getBeijingDate());
            
            // Â¶ÇÊûúÊòØÊñ∞ÁöÑ‰∏ÄÂ§©ÔºåÈáçÁΩÆÊØèÊó•‰ªªÂä°‰ΩÜ‰øùÁïôÁ¥ØËÆ°Êï∞ÊçÆ
            if (!lastActivityDate || lastActivityDate !== today) {
                resetDailyTasks();
                // ‰øùÂ≠ò‰ªäÂ§©ÁöÑÊó•Êúü‰Ωú‰∏∫ÊúÄÂêéÊ¥ªÂä®Êó•Êúü
                localStorage.setItem('lastActivityDate', today);
                
                // Â∞ÜÊò®Â§©ÁöÑÂàÜÊï∞Ê∑ªÂä†Âà∞Âë®Êï∞ÊçÆ‰∏≠
                const savedTasks = JSON.parse(localStorage.getItem('englishLearningTasks') || '{"totalPoints":0}');
                if (savedTasks.totalPoints > 0) {
                    addToWeeklyData(savedTasks.totalPoints, lastActivityDate || today);
                }
            }
        }
        
        // ÈáçÁΩÆÊØèÊó•‰ªªÂä°
        function resetDailyTasks() {
            // ÈáçÁΩÆ‰ªªÂä°Áä∂ÊÄÅ
            for (let i = 1; i <= 9; i++) {
                const checkbox = document.getElementById(`task${i}`);
                const pointElement = document.getElementById(`point${i}`);
                if (checkbox) {
                    checkbox.checked = false;
                    pointElement.textContent = '0';
                }
            }
            
            // ÈáçÁΩÆÊÄªÂàÜ
            totalPoints = 0;
            document.getElementById('current-points').textContent = totalPoints;
            document.getElementById('progress-fill').style.width = '0%';
            document.getElementById('progress-text').textContent = '0%';
            
            // Êõ¥Êñ∞ÂèØÂÖëÊç¢Â•ñÂä±ÊòæÁ§∫
            updateAvailableRewards();
            
            // ‰øùÂ≠òÈáçÁΩÆÂêéÁöÑÊï∞ÊçÆ
            saveLocalData();
        }
        
        // Ê∑ªÂä†Âà∞Âë®Êï∞ÊçÆÁªüËÆ°
        function addToWeeklyData(score, date) {
            // Âä†ËΩΩÂë®Êï∞ÊçÆ
            const savedWeeklyData = localStorage.getItem('weeklyLearningData');
            if (savedWeeklyData) {
                weeklyData = JSON.parse(savedWeeklyData);
            }
            
            // Â¶ÇÊûúÊòØÊñ∞ÁöÑ‰∏ÄÂë®ÔºåÈáçÁΩÆÂë®Êï∞ÊçÆ
            const today = getBeijingDate();
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - today.getDay() + (today.getDay() === 0 ? -6 : 1)); // Âë®‰∏Ä‰∏∫‰∏ÄÂë®ÁöÑÂºÄÂßã
            
            if (!weeklyData.startDate || new Date(weeklyData.startDate) < weekStart) {
                weeklyData = {
                    startDate: formatDate(weekStart),
                    dailyScores: []
                };
            }
            
            // Ê∑ªÂä†‰ªäÊó•ÂàÜÊï∞
            weeklyData.dailyScores.push({
                date: date,
                score: score
            });
            
            // ‰øùÂ≠òÂë®Êï∞ÊçÆ
            localStorage.setItem('weeklyLearningData', JSON.stringify(weeklyData));
        }
        
        // Âä†ËΩΩÊú¨Âú∞‰øùÂ≠òÁöÑÊï∞ÊçÆ
        function loadLocalData() {
            // Âä†ËΩΩÂë®Êï∞ÊçÆ
            const savedWeeklyData = localStorage.getItem('weeklyLearningData');
            if (savedWeeklyData) {
                weeklyData = JSON.parse(savedWeeklyData);
            }
            
            // Âä†ËΩΩ‰ªªÂä°Áä∂ÊÄÅ
            const savedTasks = localStorage.getItem('englishLearningTasks');
            if (savedTasks) {
                const tasks = JSON.parse(savedTasks);
                totalPoints = tasks.totalPoints || 0;
                
                // Êõ¥Êñ∞UI
                document.getElementById('current-points').textContent = totalPoints;
                const percentage = totalPoints;
                document.getElementById('progress-fill').style.width = `${percentage}%`;
                document.getElementById('progress-text').textContent = `${percentage}%`;
                
                // ËÆæÁΩÆÂ§çÈÄâÊ°ÜÁä∂ÊÄÅ
                for (let i = 1; i <= 9; i++) {
                    const checkbox = document.getElementById(`task${i}`);
                    const pointElement = document.getElementById(`point${i}`);
                    if (checkbox && tasks[`task${i}`]) {
                        checkbox.checked = true;
                        pointElement.textContent = tasks[`task${i}`].points;
                    }
                }
                
                updateAvailableRewards();
            }
            
            // Âä†ËΩΩÂ≠¶‰π†Êï∞ÊçÆ
            const savedLearningData = localStorage.getItem('englishLearningData');
            if (savedLearningData) {
                learningData = JSON.parse(savedLearningData);
            }
            
            // Âä†ËΩΩÂêåÊ≠•ÂéÜÂè≤
            const savedSyncHistory = localStorage.getItem('syncHistory');
            if (savedSyncHistory) {
                syncHistory = JSON.parse(savedSyncHistory);
                updateSyncHistoryDisplay();
            }
            
            // Êõ¥Êñ∞Â§©Êï∞ËÆ°Êï∞Âô®
            const startDate = new Date('2023-09-01');
            const today = getBeijingDate();
            const diffTime = Math.abs(today - startDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
            document.getElementById('day-counter').textContent = Math.min(diffDays, 84);
        }
        
        // ‰øùÂ≠òÊï∞ÊçÆÂà∞Êú¨Âú∞Â≠òÂÇ®
        function saveLocalData() {
            // ‰øùÂ≠ò‰ªªÂä°Áä∂ÊÄÅ
            const tasksToSave = {
                totalPoints: totalPoints
            };
            
            for (let i = 1; i <= 9; i++) {
                const checkbox = document.getElementById(`task${i}`);
                const pointElement = document.getElementById(`point${i}`);
                if (checkbox && checkbox.checked) {
                    tasksToSave[`task${i}`] = {
                        checked: true,
                        points: parseInt(pointElement.textContent)
                    };
                }
            }
            
            localStorage.setItem('englishLearningTasks', JSON.stringify(tasksToSave));
            
            // ‰øùÂ≠òÂ≠¶‰π†Êï∞ÊçÆ
            localStorage.setItem('englishLearningData', JSON.stringify(learningData));
            
            // ‰øùÂ≠òÊúÄÂêéÊ¥ªÂä®Êó•Êúü
            localStorage.setItem('lastActivityDate', formatDate(getBeijingDate()));
            
            // ÊòæÁ§∫‰øùÂ≠òÊèêÁ§∫
            const indicator = document.getElementById('save-indicator');
            indicator.style.opacity = '1';
            setTimeout(() => {
                indicator.style.opacity = '0';
            }, 2000);
            
            // Êï∞ÊçÆÂèòÂåñÂêéËá™Âä®Êõ¥Êñ∞ÁªüËÆ°
            calculateAllStats();
            
            // Ëá™Âä®ÂêåÊ≠•ÔºàÂ¶ÇÊûúÂ∑≤ÈÖçÁΩÆ‰∏îÊï∞ÊçÆÊúâÂèòÂåñÔºâ
            if (syncSettings.cloudSyncEnabled && syncSettings.userId && 
                (lastSyncTime === null || new Date() - lastSyncTime > 300000)) { // 5ÂàÜÈíüÂÜÖ‰∏çÈáçÂ§çÂêåÊ≠•
                syncData();
            }
        }
        
        // ÂêåÊ≠•ËÆæÁΩÆÁõ∏ÂÖ≥ÂáΩÊï∞
        function loadSyncSettings() {
            const savedSettings = localStorage.getItem('syncSettings');
            if (savedSettings) {
                syncSettings = JSON.parse(savedSettings);
                document.getElementById('user-id').value = syncSettings.userId || '';
                document.getElementById('github-token').value = syncSettings.githubToken || '';
                document.getElementById('gist-id').value = syncSettings.gistId || '';
                
                // Êõ¥Êñ∞ÂêåÊ≠•Áä∂ÊÄÅÊòæÁ§∫
                updateSyncStatusDisplay();
            }
            
            // Âä†ËΩΩÊúÄÂêéÂêåÊ≠•Êó∂Èó¥
            const savedLastSync = localStorage.getItem('lastSyncTime');
            if (savedLastSync) {
                lastSyncTime = new Date(savedLastSync);
                document.getElementById('last-sync-time').textContent = lastSyncTime.toLocaleString();
            }
        }
        
        function saveSyncSettings() {
            syncSettings.userId = document.getElementById('user-id').value;
            syncSettings.githubToken = document.getElementById('github-token').value;
            syncSettings.gistId = document.getElementById('gist-id').value;
            
            localStorage.setItem('syncSettings', JSON.stringify(syncSettings));
            
            // Êõ¥Êñ∞ÂêåÊ≠•Áä∂ÊÄÅÊòæÁ§∫
            updateSyncStatusDisplay();
            
            addSyncHistory('ÂêåÊ≠•ËÆæÁΩÆÂ∑≤‰øùÂ≠ò');
            showSyncStatus('ËÆæÁΩÆÂ∑≤‰øùÂ≠ò');
        }
        
        function toggleCloudSync() {
            const userId = document.getElementById('user-id').value;
            if (!userId && !syncSettings.cloudSyncEnabled) {
                alert('ËØ∑ÂÖàËæìÂÖ•Áî®Êà∑ID');
                document.getElementById('user-id').focus();
                return;
            }
            
            syncSettings.cloudSyncEnabled = !syncSettings.cloudSyncEnabled;
            saveSyncSettings();
            
            if (syncSettings.cloudSyncEnabled) {
                addSyncHistory('‰∫ëÂêåÊ≠•Â∑≤ÂêØÁî®');
                showSyncStatus('‰∫ëÂêåÊ≠•Â∑≤ÂêØÁî®');
                // Á´ãÂç≥ÂêåÊ≠•‰∏ÄÊ¨°
                syncData();
            } else {
                addSyncHistory('‰∫ëÂêåÊ≠•Â∑≤Á¶ÅÁî®');
                showSyncStatus('‰∫ëÂêåÊ≠•Â∑≤Á¶ÅÁî®');
            }
        }
        
        function updateSyncStatusDisplay() {
            document.getElementById('cloud-sync-status').textContent = 
                syncSettings.cloudSyncEnabled ? 'Â∑≤ÂêØÁî®' : 'Êú™ÂêØÁî®';
            
            document.getElementById('sync-toggle-text').textContent = 
                syncSettings.cloudSyncEnabled ? 'Á¶ÅÁî®‰∫ëÂêåÊ≠•' : 'ÂêØÁî®‰∫ëÂêåÊ≠•';
        }
        
        function createNewGist() {
            if (!syncSettings.githubToken) {
                alert('ËØ∑ÂÖàËæìÂÖ•GitHub‰∏™‰∫∫ËÆøÈóÆ‰ª§Áâå');
                return;
            }
            
            showSyncingStatus();
            
            const fileContent = JSON.stringify({
                lastUpdated: new Date().toISOString(),
                userId: syncSettings.userId,
                tasks: JSON.parse(localStorage.getItem('englishLearningTasks') || '{"totalPoints":0}'),
                learningData: learningData,
                weeklyData: weeklyData
            }, null, 2);
            
            fetch('https://api.github.com/gists', {
                method: 'POST',
                headers: {
                    'Authorization': `token ${syncSettings.githubToken}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    description: 'Ëã±ËØ≠Â≠¶‰π†Á≥ªÁªüÊï∞ÊçÆÂ≠òÂÇ®',
                    public: false,
                    files: {
                        'english_learning_data.json': {
                            content: fileContent
                        }
                    }
                })
            })
            .then(response => {
                if (!response.ok) throw new Error('ÂàõÂª∫GistÂ§±Ë¥•');
                return response.json();
            })
            .then(data => {
                syncSettings.gistId = data.id;
                document.getElementById('gist-id').value = data.id;
                saveSyncSettings();
                addSyncHistory('Â∑≤ÂàõÂª∫Êñ∞GistÂπ∂ÂêåÊ≠•Êï∞ÊçÆ');
                showSyncStatus('GistÂàõÂª∫ÊàêÂäü');
            })
            .catch(error => {
                console.error('ÂàõÂª∫GistÈîôËØØ:', error);
                showSyncStatus('ÂàõÂª∫Â§±Ë¥•: ' + error.message);
                addSyncHistory('ÂàõÂª∫GistÂ§±Ë¥•: ' + error.message);
            });
        }
        
        // ÊâãÂä®ÂêåÊ≠•ÂäüËÉΩ
        function manualSync() {
            if (!syncSettings.cloudSyncEnabled) {
                alert('ËØ∑ÂÖàÂêØÁî®‰∫ëÂêåÊ≠•');
                return;
            }
            
            if (!syncSettings.userId) {
                alert('ËØ∑ÂÖàËÆæÁΩÆÁî®Êà∑ID');
                document.getElementById('user-id').focus();
                return;
            }
            
            syncData();
        }
        
        // ÂØºÂá∫Êï∞ÊçÆÂäüËÉΩ
        function exportData() {
            const exportData = {
                lastUpdated: new Date().toISOString(),
                userId: syncSettings.userId,
                tasks: JSON.parse(localStorage.getItem('englishLearningTasks') || '{"totalPoints":0}'),
                learningData: learningData,
                weeklyData: weeklyData
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `english_learning_data_${formatDate(new Date())}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            addSyncHistory('Êï∞ÊçÆÂ∑≤ÂØºÂá∫');
            showSyncStatus('Êï∞ÊçÆÂØºÂá∫ÊàêÂäü');
        }
        
        // ÂØºÂÖ•Êï∞ÊçÆÂäüËÉΩ
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (confirm('Á°ÆÂÆöË¶ÅÂØºÂÖ•Êï∞ÊçÆÂêóÔºüËøôÂ∞ÜË¶ÜÁõñÂΩìÂâçÊï∞ÊçÆ„ÄÇ')) {
                        // Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®
                        if (importedData.tasks) {
                            localStorage.setItem('englishLearningTasks', JSON.stringify(importedData.tasks));
                        }
                        if (importedData.learningData) {
                            learningData = importedData.learningData;
                            localStorage.setItem('englishLearningData', JSON.stringify(learningData));
                        }
                        if (importedData.weeklyData) {
                            weeklyData = importedData.weeklyData;
                            localStorage.setItem('weeklyLearningData', JSON.stringify(weeklyData));
                        }
                        
                        // Â¶ÇÊûúÂØºÂÖ•Êï∞ÊçÆÂåÖÂê´Áî®Êà∑IDÔºåÊõ¥Êñ∞ÂΩìÂâçÁî®Êà∑ID
                        if (importedData.userId) {
                            syncSettings.userId = importedData.userId;
                            document.getElementById('user-id').value = importedData.userId;
                            saveSyncSettings();
                        }
                        
                        // ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆÂπ∂Êõ¥Êñ∞UI
                        loadLocalData();
                        displayLearningRecords();
                        calculateAllStats();
                        
                        addSyncHistory('Êï∞ÊçÆÂ∑≤ÂØºÂÖ•');
                        showSyncStatus('Êï∞ÊçÆÂØºÂÖ•ÊàêÂäü');
                    }
                } catch (error) {
                    console.error('ÂØºÂÖ•Êï∞ÊçÆÈîôËØØ:', error);
                    alert('ÂØºÂÖ•Â§±Ë¥•: Êó†ÊïàÁöÑJSONÊñá‰ª∂');
                    addSyncHistory('Êï∞ÊçÆÂØºÂÖ•Â§±Ë¥•: Êó†ÊïàÊñá‰ª∂');
                }
            };
            reader.readAsText(file);
            
            // ÈáçÁΩÆÊñá‰ª∂ËæìÂÖ•ÔºåÂÖÅËÆ∏ÈáçÂ§çÈÄâÊã©Âêå‰∏Ä‰∏™Êñá‰ª∂
            document.getElementById('import-file').value = '';
        }
        
        // Êï∞ÊçÆÂêåÊ≠•Áõ∏ÂÖ≥ÂáΩÊï∞
        function syncData() {
            if (!syncSettings.cloudSyncEnabled) {
                alert('ËØ∑ÂÖàÂêØÁî®‰∫ëÂêåÊ≠•');
                return;
            }
            
            if (!syncSettings.userId) {
                alert('ËØ∑ÂÖàËÆæÁΩÆÁî®Êà∑ID');
                document.getElementById('user-id').focus();
                return;
            }
            
            showSyncingStatus();
            
            // Ê£ÄÊü•ÊòØÂê¶‰ΩøÁî®GitHub GistÂêåÊ≠•
            if (syncSettings.githubToken && syncSettings.gistId) {
                syncWithGitHub();
            } else {
                // ‰ΩøÁî®localStorageÊ®°Êãü‰∫ëÂêåÊ≠•
                syncWithLocalStorage();
            }
        }
        
        // ‰ΩøÁî®GitHubÂêåÊ≠•
        function syncWithGitHub() {
            // ÂÖàËé∑ÂèñËøúÁ®ãÊï∞ÊçÆ
            fetch(`https://api.github.com/gists/${syncSettings.gistId}`, {
                headers: {
                    'Authorization': `token ${syncSettings.githubToken}`
                }
            })
            .then(response => {
                if (!response.ok) {
                    if (response.status === 404) {
                        // Gist‰∏çÂ≠òÂú®ÔºåÂàõÂª∫Êñ∞ÁöÑ
                        return createNewGist().then(() => null);
                    }
                    throw new Error('Ëé∑ÂèñËøúÁ®ãÊï∞ÊçÆÂ§±Ë¥•');
                }
                return response.json();
            })
            .then(remoteGist => {
                if (!remoteGist) return; // Â¶ÇÊûúÊòØÊñ∞Âª∫ÁöÑGistÔºåÁõ¥Êé•ËøîÂõû
                
                const remoteData = JSON.parse(
                    remoteGist.files['english_learning_data.json'].content
                );
                
                // È™åËØÅÁî®Êà∑IDÂåπÈÖç
                if (remoteData.userId && remoteData.userId !== syncSettings.userId) {
                    throw new Error('Áî®Êà∑ID‰∏çÂåπÈÖçÔºåÊó†Ê≥ïÂêåÊ≠•');
                }
                
                const localLastUpdated = localStorage.getItem('lastSyncTime') || new Date(0).toISOString();
                
                // ÊØîËæÉËøúÁ®ãÂíåÊú¨Âú∞Êï∞ÊçÆÁöÑÊõ¥Êñ∞Êó∂Èó¥
                if (new Date(remoteData.lastUpdated) > new Date(localLastUpdated)) {
                    // ËøúÁ®ãÊï∞ÊçÆÊõ¥Êñ∞Ôºå‰ΩøÁî®ËøúÁ®ãÊï∞ÊçÆ
                    return new Promise((resolve) => {
                        if (confirm('ÂèëÁé∞Êõ¥Êñ∞ÁöÑÊï∞ÊçÆÔºåÊòØÂê¶ÂêåÊ≠•Âà∞Êú¨Âú∞Ôºü')) {
                            localStorage.setItem('englishLearningTasks', JSON.stringify(remoteData.tasks));
                            learningData = remoteData.learningData;
                            weeklyData = remoteData.weeklyData;
                            localStorage.setItem('englishLearningData', JSON.stringify(learningData));
                            localStorage.setItem('weeklyLearningData', JSON.stringify(weeklyData));
                            
                            loadLocalData(); // ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆÊõ¥Êñ∞UI
                            displayLearningRecords(); // Êõ¥Êñ∞Â≠¶‰π†ËÆ∞ÂΩïÊòæÁ§∫
                            calculateAllStats(); // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
                            addSyncHistory('Â∑≤‰ªéËøúÁ®ãÂêåÊ≠•ÊúÄÊñ∞Êï∞ÊçÆ');
                            resolve(true);
                        } else {
                            resolve(false);
                        }
                    });
                } else {
                    // Êú¨Âú∞Êï∞ÊçÆÊõ¥Êñ∞Ôºå‰∏ä‰º†Âà∞ËøúÁ®ã
                    return false;
                }
            })
            .then(remoteWasNewer => {
                if (remoteWasNewer === null) return; // Êñ∞Âª∫GistÁöÑÊÉÖÂÜµ
                
                if (!remoteWasNewer) {
                    // ‰∏ä‰º†Êú¨Âú∞Êï∞ÊçÆÂà∞ËøúÁ®ã
                    const fileContent = JSON.stringify({
                        lastUpdated: new Date().toISOString(),
                        userId: syncSettings.userId,
                        tasks: JSON.parse(localStorage.getItem('englishLearningTasks') || '{"totalPoints":0}'),
                        learningData: learningData,
                        weeklyData: weeklyData
                    }, null, 2);
                    
                    return fetch(`https://api.github.com/gists/${syncSettings.gistId}`, {
                        method: 'PATCH',
                        headers: {
                            'Authorization': `token ${syncSettings.githubToken}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            files: {
                                'english_learning_data.json': {
                                    content: fileContent
                                }
                            }
                        })
                    })
                    .then(response => {
                        if (!response.ok) throw new Error('‰∏ä‰º†Êï∞ÊçÆÂ§±Ë¥•');
                        localStorage.setItem('lastSyncTime', new Date().toISOString());
                        lastSyncTime = new Date();
                        document.getElementById('last-sync-time').textContent = lastSyncTime.toLocaleString();
                        addSyncHistory('Â∑≤Â∞ÜÊú¨Âú∞Êï∞ÊçÆÂêåÊ≠•Âà∞ËøúÁ®ã');
                        return true;
                    });
                }
                return true;
            })
            .then(success => {
                if (success) {
                    showSyncStatus('ÂêåÊ≠•ÊàêÂäü');
                }
            })
            .catch(error => {
                console.error('ÂêåÊ≠•ÈîôËØØ:', error);
                showSyncStatus('ÂêåÊ≠•Â§±Ë¥•: ' + error.message);
                addSyncHistory('ÂêåÊ≠•Â§±Ë¥•: ' + error.message);
            });
        }
        
        // ‰ΩøÁî®localStorageÊ®°Êãü‰∫ëÂêåÊ≠•
        function syncWithLocalStorage() {
            try {
                // Â≠òÂÇ®ÈîÆÂåÖÂê´Áî®Êà∑IDÔºåÂÆûÁé∞Â§öÁî®Êà∑ÈöîÁ¶ª
                const storageKey = `cloud_sync_${syncSettings.userId}`;
                
                // Ëé∑ÂèñËøúÁ®ãÊï∞ÊçÆÔºàÂÆûÈôÖÊòØlocalStorage‰∏≠ÁöÑÊï∞ÊçÆÔºâ
                const remoteDataStr = localStorage.getItem(storageKey);
                const localLastUpdated = localStorage.getItem('lastSyncTime') || new Date(0).toISOString();
                
                if (remoteDataStr) {
                    const remoteData = JSON.parse(remoteDataStr);
                    
                    // ÊØîËæÉËøúÁ®ãÂíåÊú¨Âú∞Êï∞ÊçÆÁöÑÊõ¥Êñ∞Êó∂Èó¥
                    if (new Date(remoteData.lastUpdated) > new Date(localLastUpdated)) {
                        // ËøúÁ®ãÊï∞ÊçÆÊõ¥Êñ∞Ôºå‰ΩøÁî®ËøúÁ®ãÊï∞ÊçÆ
                        if (confirm('ÂèëÁé∞Êõ¥Êñ∞ÁöÑÊï∞ÊçÆÔºåÊòØÂê¶ÂêåÊ≠•Âà∞Êú¨Âú∞Ôºü')) {
                            localStorage.setItem('englishLearningTasks', JSON.stringify(remoteData.tasks));
                            learningData = remoteData.learningData;
                            weeklyData = remoteData.weeklyData;
                            localStorage.setItem('englishLearningData', JSON.stringify(learningData));
                            localStorage.setItem('weeklyLearningData', JSON.stringify(weeklyData));
                            
                            loadLocalData(); // ÈáçÊñ∞Âä†ËΩΩÊï∞ÊçÆÊõ¥Êñ∞UI
                            displayLearningRecords(); // Êõ¥Êñ∞Â≠¶‰π†ËÆ∞ÂΩïÊòæÁ§∫
                            calculateAllStats(); // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
                            addSyncHistory('Â∑≤‰ªé‰∫ëÂêåÊ≠•ÊúÄÊñ∞Êï∞ÊçÆ');
                        }
                    }
                }
                
                // ‰∏ä‰º†Êú¨Âú∞Êï∞ÊçÆÂà∞"‰∫ëÁ´Ø"ÔºàÂÆûÈôÖÊòØlocalStorageÔºâ
                const localData = {
                    lastUpdated: new Date().toISOString(),
                    userId: syncSettings.userId,
                    tasks: JSON.parse(localStorage.getItem('englishLearningTasks') || '{"totalPoints":0}'),
                    learningData: learningData,
                    weeklyData: weeklyData
                };
                
                localStorage.setItem(storageKey, JSON.stringify(localData));
                localStorage.setItem('lastSyncTime', new Date().toISOString());
                lastSyncTime = new Date();
                document.getElementById('last-sync-time').textContent = lastSyncTime.toLocaleString();
                
                addSyncHistory('Êú¨Âú∞Êï∞ÊçÆÂ∑≤ÂêåÊ≠•Âà∞‰∫ëÁ´Ø');
                showSyncStatus('ÂêåÊ≠•ÊàêÂäü');
            } catch (error) {
                console.error('ÂêåÊ≠•ÈîôËØØ:', error);
                showSyncStatus('ÂêåÊ≠•Â§±Ë¥•: ' + error.message);
                addSyncHistory('ÂêåÊ≠•Â§±Ë¥•: ' + error.message);
            }
        }
        
        function addSyncHistory(message) {
            const now = new Date();
            const timeString = now.toLocaleString();
            syncHistory.unshift({
                time: timeString,
                message: message
            });
            
            // Âè™‰øùÁïôÊúÄËøë10Êù°ËÆ∞ÂΩï
            if (syncHistory.length > 10) {
                syncHistory = syncHistory.slice(0, 10);
            }
            
            localStorage.setItem('syncHistory', JSON.stringify(syncHistory));
            updateSyncHistoryDisplay();
        }
        
        function updateSyncHistoryDisplay() {
            const historyElement = document.getElementById('sync-history');
            if (syncHistory.length === 0) {
                historyElement.textContent = 'ÊöÇÊó†ÂêåÊ≠•ËÆ∞ÂΩï';
                return;
            }
            
            let html = '<ul style="padding-left: 20px;">';
            syncHistory.forEach(item => {
                html += `<li><strong>${item.time}</strong>: ${item.message}</li>`;
            });
            html += '</ul>';
            historyElement.innerHTML = html;
        }
        
        function showSyncingStatus() {
            document.getElementById('sync-status-text').textContent = 'ÂêåÊ≠•‰∏≠...';
            document.querySelector('.sync-icon').style.display = 'inline';
        }
        
        function showSyncStatus(message) {
            document.getElementById('sync-status-text').textContent = message;
            document.querySelector('.sync-icon').style.display = 'none';
        }
        
        // ÂéüÊúâÂäüËÉΩÂáΩÊï∞
        function switchTab(tabId) {
            // ÈöêËóèÊâÄÊúâÊ†áÁ≠æÂÜÖÂÆπ
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ÂèñÊ∂àÊâÄÊúâÊ†áÁ≠æÁöÑÊ¥ªÂä®Áä∂ÊÄÅ
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ÊòæÁ§∫ÈÄâ‰∏≠ÁöÑÊ†áÁ≠æÂÜÖÂÆπ
            document.getElementById(tabId).classList.add('active');
            
            // ËÆæÁΩÆÈÄâ‰∏≠ÁöÑÊ†áÁ≠æ‰∏∫Ê¥ªÂä®Áä∂ÊÄÅ
            document.querySelector(`.nav-tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
            
            // ‰øùÂ≠òÊï∞ÊçÆ
            saveLocalData();
        }
        
        // ÂàáÊç¢ÁªüËÆ°Ê†áÁ≠æÈ°µ
        function switchStatsTab(tabId) {
            // ÈöêËóèÊâÄÊúâÁªüËÆ°ÂÜÖÂÆπ
            document.querySelectorAll('.stats-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ÂèñÊ∂àÊâÄÊúâÁªüËÆ°Ê†áÁ≠æÁöÑÊ¥ªÂä®Áä∂ÊÄÅ
            document.querySelectorAll('.stats-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ÊòæÁ§∫ÈÄâ‰∏≠ÁöÑÁªüËÆ°ÂÜÖÂÆπ
            document.getElementById(tabId).classList.add('active');
            
            // ËÆæÁΩÆÈÄâ‰∏≠ÁöÑÁªüËÆ°Ê†áÁ≠æ‰∏∫Ê¥ªÂä®Áä∂ÊÄÅ
            document.querySelector(`.stats-tab[onclick="switchStatsTab('${tabId}')"]`).classList.add('active');
        }
        
        function updatePoints(points, checkbox) {
            const row = checkbox.closest('tr');
            const pointId = row.id;
            const pointElement = document.getElementById(`point${pointId}`);
            
            if (checkbox.checked) {
                totalPoints += points;
                pointElement.textContent = points;
            } else {
                totalPoints -= points;
                pointElement.textContent = '0';
            }
            
            document.getElementById('current-points').textContent = totalPoints;
            const percentage = totalPoints;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-text').textContent = `${percentage}%`;
            
            // Êõ¥Êñ∞ÂèØÂÖëÊç¢Â•ñÂä±ÊòæÁ§∫
            updateAvailableRewards();
            
            // ‰øùÂ≠òÊï∞ÊçÆ
            saveLocalData();
        }
        
        function updateDate() {
            const dateInput = document.getElementById('date');
            const selectedDate = new Date(dateInput.value);
            const startDate = new Date('2023-09-01'); // ËÆ°ÂàíÂºÄÂßãÊó•Êúü
            const diffTime = Math.abs(selectedDate - startDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
            
            if (diffDays >= 1 && diffDays <= 84) {
                document.getElementById('day-counter').textContent = diffDays;
            } else {
                alert('ËØ∑ËæìÂÖ•84Â§©ËÆ°ÂàíÂÜÖÁöÑÊúâÊïàÊó•Êúü');
            }
            
            // ‰øùÂ≠òÊï∞ÊçÆ
            saveLocalData();
        }
        
        // Â≠¶‰π†Êï∞ÊçÆÁÆ°ÁêÜÂäüËÉΩ
        function saveLearningData() {
            const date = document.getElementById('learning-date').value;
            if (!date) {
                alert('ËØ∑ÈÄâÊã©Êó•Êúü');
                return;
            }
            
            const data = {
                date: date,
                studyTime: document.getElementById('study-time').value,
                vocabScore: document.getElementById('vocab-score').value,
                listeningScore: document.getElementById('listening-score').value,
                readingScore: document.getElementById('reading-score').value,
                writingScore: document.getElementById('writing-score').value,
                externalScore: document.getElementById('external-score').value,
                errorType: document.getElementById('error-types').value
            };
            
            // ËÆ°ÁÆóÊÄªÂàÜ
            const total = parseInt(data.vocabScore || 0) + 
                          parseInt(data.listeningScore || 0) + 
                          parseInt(data.readingScore || 0) + 
                          parseInt(data.writingScore || 0) + 
                          parseInt(data.externalScore || 0);
            
            // Ê£ÄÊü•ÊòØÂê¶ÊòØÁºñËæëÊ®°Âºè
            if (currentEditingIndex !== -1) {
                // Êõ¥Êñ∞Áé∞ÊúâËÆ∞ÂΩï
                learningData[currentEditingIndex] = data;
                alert(`Â≠¶‰π†Êï∞ÊçÆÂ∑≤Êõ¥Êñ∞ÔºÅÊÄªÂàÜ: ${total}`);
                currentEditingIndex = -1; // ÈáçÁΩÆÁºñËæëÁä∂ÊÄÅ
            } else {
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÊúâËØ•Êó•ÊúüÁöÑÊï∞ÊçÆ
                const existingIndex = learningData.findIndex(item => item.date === data.date);
                if (existingIndex >= 0) {
                    if (confirm('ËØ•Êó•ÊúüÂ∑≤ÊúâÊï∞ÊçÆÔºåÊòØÂê¶Ë¶ÜÁõñÔºü')) {
                        learningData[existingIndex] = data;
                        alert(`Â≠¶‰π†Êï∞ÊçÆÂ∑≤Êõ¥Êñ∞ÔºÅÊÄªÂàÜ: ${total}`);
                    } else {
                        return;
                    }
                } else {
                    // Ê∑ªÂä†Êñ∞ËÆ∞ÂΩï
                    learningData.push(data);
                    alert(`Â≠¶‰π†Êï∞ÊçÆÂ∑≤‰øùÂ≠òÔºÅÊÄªÂàÜ: ${total}ÔºåÂ∑≤‰øùÂ≠ò${learningData.length}Êù°ËÆ∞ÂΩï`);
                }
            }
            
            // Ê∏ÖÁ©∫Ë°®Âçï
            clearForm();
            
            // ‰øùÂ≠òÊï∞ÊçÆÂπ∂Êõ¥Êñ∞ÊòæÁ§∫
            saveLocalData();
            displayLearningRecords();
        }
        
        function clearForm() {
            document.getElementById('study-time').value = '';
            document.getElementById('vocab-score').value = '';
            document.getElementById('listening-score').value = '';
            document.getElementById('reading-score').value = '';
            document.getElementById('writing-score').value = '';
            document.getElementById('external-score').value = '';
            document.getElementById('error-types').value = '';
            currentEditingIndex = -1; // ÈáçÁΩÆÁºñËæëÁä∂ÊÄÅ
        }
        
        function displayLearningRecords() {
            const container = document.getElementById('records-container');
            
            if (learningData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div>üìä</div>
                        <h3>ÊöÇÊó†Â≠¶‰π†ËÆ∞ÂΩï</h3>
                        <p>ËØ∑Âú®‰∏äÊñπË°®Âçï‰∏≠Ê∑ªÂä†ÊÇ®ÁöÑÁ¨¨‰∏ÄÊù°Â≠¶‰π†ËÆ∞ÂΩï</p>
                    </div>
                `;
                return;
            }
            
            // ÊåâÊó•ÊúüÈôçÂ∫èÊéíÂ∫è
            const sortedData = [...learningData].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>Êó•Êúü</th>
                            <th>Â≠¶‰π†Êó∂Èó¥(ÂàÜÈíü)</th>
                            <th>ÊÄªÂàÜ</th>
                            <th>‰∏ªË¶ÅÈîôËØØ</th>
                            <th>Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            sortedData.forEach((data, index) => {
                const totalScore = parseInt(data.vocabScore || 0) + 
                                  parseInt(data.listeningScore || 0) + 
                                  parseInt(data.readingScore || 0) + 
                                  parseInt(data.writingScore || 0) + 
                                  parseInt(data.externalScore || 0);
                
                // ËΩ¨Êç¢ÈîôËØØÁ±ªÂûã‰∏∫‰∏≠ÊñáÊòæÁ§∫
                let errorTypeText = "Êó†";
                switch(data.errorType) {
                    case "vocabulary": errorTypeText = "ËØçÊ±á‰∏çË∂≥"; break;
                    case "grammar": errorTypeText = "ËØ≠Ê≥ïÈîôËØØ"; break;
                    case "comprehension": errorTypeText = "ÁêÜËß£ÂÅèÂ∑Æ"; break;
                    case "time": errorTypeText = "Êó∂Èó¥‰∏çË∂≥"; break;
                    case "focus": errorTypeText = "Ê≥®ÊÑèÂäõ‰∏çÈõÜ‰∏≠"; break;
                }
                
                html += `
                    <tr>
                        <td>${data.date}</td>
                        <td>${data.studyTime || 0}</td>
                        <td class="points">${totalScore}</td>
                        <td>${errorTypeText}</td>
                        <td class="record-actions">
                            <button class="btn btn-small" onclick="editRecord(${index})">ÁºñËæë</button>
                            <button class="btn btn-small btn-danger" onclick="deleteRecord(${index})">Âà†Èô§</button>
                        </td>
                    </tr>
                `;
            });
            
            html += `
                    </tbody>
                </table>
                <p style="margin-top: 15px; color: var(--text-light);">ÂÖ± ${learningData.length} Êù°ËÆ∞ÂΩï</p>
            `;
            
            container.innerHTML = html;
        }
        
        function editRecord(index) {
            const data = learningData[index];
            currentEditingIndex = index;
            
            // Â°´ÂÖÖË°®Âçï
            document.getElementById('learning-date').value = data.date;
            document.getElementById('study-time').value = data.studyTime || '';
            document.getElementById('vocab-score').value = data.vocabScore || '';
            document.getElementById('listening-score').value = data.listeningScore || '';
            document.getElementById('reading-score').value = data.readingScore || '';
            document.getElementById('writing-score').value = data.writingScore || '';
            document.getElementById('external-score').value = data.externalScore || '';
            document.getElementById('error-types').value = data.errorType || '';
            
            // ÊªöÂä®Âà∞Ë°®ÂçïÈ°∂ÈÉ®
            document.querySelector('.data-form').scrollIntoView({ behavior: 'smooth' });
        }
        
        function deleteRecord(index) {
            if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§ ${learningData[index].date} ÁöÑËÆ∞ÂΩïÂêóÔºü`)) {
                learningData.splice(index, 1);
                saveLocalData();
                displayLearningRecords();
                alert('ËÆ∞ÂΩïÂ∑≤Âà†Èô§');
            }
        }
        
        function filterRecords() {
            const searchTerm = document.getElementById('record-search').value.toLowerCase();
            
            if (!searchTerm) {
                displayLearningRecords();
                return;
            }
            
            const filteredData = learningData.filter(data => {
                // ËΩ¨Êç¢ÈîôËØØÁ±ªÂûã‰∏∫‰∏≠Êñá‰ª•‰æøÊêúÁ¥¢
                let errorTypeText = "";
                switch(data.errorType) {
                    case "vocabulary": errorTypeText = "ËØçÊ±á‰∏çË∂≥"; break;
                    case "grammar": errorTypeText = "ËØ≠Ê≥ïÈîôËØØ"; break;
                    case "comprehension": errorTypeText = "ÁêÜËß£ÂÅèÂ∑Æ"; break;
                    case "time": errorTypeText = "Êó∂Èó¥‰∏çË∂≥"; break;
                    case "focus": errorTypeText = "Ê≥®ÊÑèÂäõ‰∏çÈõÜ‰∏≠"; break;
                }
                
                return data.date.toLowerCase().includes(searchTerm) || 
                       errorTypeText.toLowerCase().includes(searchTerm);
            });
            
            const container = document.getElementById('records-container');
            
            if (filteredData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div>üîç</div>
                        <h3>Êú™ÊâæÂà∞ÂåπÈÖçËÆ∞ÂΩï</h3>
                        <p>ËØ∑Â∞ùËØïÂÖ∂‰ªñÊêúÁ¥¢ÂÖ≥ÈîÆËØç</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>Êó•Êúü</th>
                            <th>Â≠¶‰π†Êó∂Èó¥(ÂàÜÈíü)</th>
                            <th>ÊÄªÂàÜ</th>
                            <th>‰∏ªË¶ÅÈîôËØØ</th>
                            <th>Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            filteredData.forEach((data, index) => {
                // ÊâæÂà∞ÂéüÂßãÁ¥¢Âºï
                const originalIndex = learningData.findIndex(item => item.date === data.date);
                if (originalIndex === -1) return;
                
                const totalScore = parseInt(data.vocabScore || 0) + 
                                  parseInt(data.listeningScore || 0) + 
                                  parseInt(data.readingScore || 0) + 
                                  parseInt(data.writingScore || 0) + 
                                  parseInt(data.externalScore || 0);
                
                // ËΩ¨Êç¢ÈîôËØØÁ±ªÂûã‰∏∫‰∏≠ÊñáÊòæÁ§∫
                let errorTypeText = "Êó†";
                switch(data.errorType) {
                    case "vocabulary": errorTypeText = "ËØçÊ±á‰∏çË∂≥"; break;
                    case "grammar": errorTypeText = "ËØ≠Ê≥ïÈîôËØØ"; break;
                    case "comprehension": errorTypeText = "ÁêÜËß£ÂÅèÂ∑Æ"; break;
                    case "time": errorTypeText = "Êó∂Èó¥‰∏çË∂≥"; break;
                    case "focus": errorTypeText = "Ê≥®ÊÑèÂäõ‰∏çÈõÜ‰∏≠"; break;
                }
                
                html += `
                    <tr>
                        <td>${data.date}</td>
                        <td>${data.studyTime || 0}</td>
                        <td class="points">${totalScore}</td>
                        <td>${errorTypeText}</td>
                        <td class="record-actions">
                            <button class="btn btn-small" onclick="editRecord(${originalIndex})">ÁºñËæë</button>
                            <button class="btn btn-small btn-danger" onclick="deleteRecord(${originalIndex})">Âà†Èô§</button>
                        </td>
                    </tr>
                `;
            });
            
            html += `
                    </tbody>
                </table>
                <p style="margin-top: 15px; color: var(--text-light);">ÊâæÂà∞ ${filteredData.length} Êù°ÂåπÈÖçËÆ∞ÂΩï</p>
            `;
            
            container.innerHTML = html;
        }
        
        function showAllRecords() {
            document.getElementById('record-search').value = '';
            displayLearningRecords();
        }
        
        // ËÆ°ÁÆóÊâÄÊúâÁªüËÆ°Êï∞ÊçÆ
        function calculateAllStats() {
            if (learningData.length === 0) {
                clearAllStats();
                return;
            }
            
            // Ëé∑ÂèñÂΩìÂâçÊó•Êúü
            const today = getBeijingDate();
            
            // ËÆ°ÁÆóÊú¨Âë®Êï∞ÊçÆ
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - today.getDay() + (today.getDay() === 0 ? -6 : 1)); // Âë®‰∏Ä
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 6); // Âë®Êó•
            
            const weeklyData = learningData.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate >= weekStart && itemDate <= weekEnd;
            });
            
            calculatePeriodStats(weeklyData, 'weekly', formatDate(weekStart), formatDate(weekEnd));
            
            // ËÆ°ÁÆóÊú¨ÊúàÊï∞ÊçÆ
            const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
            const monthEnd = new Date(today.getFullYear(), today.getMonth() + 1, 0);
            
            const monthlyData = learningData.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate >= monthStart && itemDate <= monthEnd;
            });
            
            calculatePeriodStats(monthlyData, 'monthly', formatDate(monthStart), formatDate(monthEnd));
            
            // ËÆ°ÁÆóÊï¥‰ΩìÊï∞ÊçÆ
            if (learningData.length > 0) {
                const firstDate = new Date(learningData.reduce((a, b) => new Date(a.date) < new Date(b.date) ? a : b).date);
                const lastDate = new Date(learningData.reduce((a, b) => new Date(a.date) > new Date(b.date) ? a : b).date);
                
                calculatePeriodStats(learningData, 'overall', formatDate(firstDate), formatDate(lastDate));
                
                // Êï¥‰ΩìÁªüËÆ°ÁâπÊúâÊï∞ÊçÆ
                document.getElementById('overall-days').textContent = learningData.length;
                
                // ËÆ°ÁÆóËææÊàêÁéáÔºàËææÂà∞80ÂàÜÁöÑÊØî‰æãÔºâ
                const targetDays = learningData.filter(data => {
                    const dailyScore = parseInt(data.vocabScore || 0) + 
                                      parseInt(data.listeningScore || 0) + 
                                      parseInt(data.readingScore || 0) + 
                                      parseInt(data.writingScore || 0) + 
                                      parseInt(data.externalScore || 0);
                    return dailyScore >= 80;
                }).length;
                
                const achievement = Math.round((targetDays / learningData.length) * 100);
                document.getElementById('overall-achievement').textContent = achievement + '%';
            }
        }
        
        // Ê∏ÖÈô§ÊâÄÊúâÁªüËÆ°Êï∞ÊçÆ
        function clearAllStats() {
            ['weekly', 'monthly', 'overall'].forEach(period => {
                document.getElementById(`${period}-avg-score`).textContent = '0';
                document.getElementById(`${period}-strongest`).textContent = '--';
                document.getElementById(`${period}-weakest`).textContent = '--';
                document.getElementById(`${period}-avg-time`).textContent = '0';
                document.getElementById(`${period}-period`).textContent = '-- Ëá≥ --';
                document.getElementById(`${period}-errors`).textContent = 'ÊöÇÊó†Êï∞ÊçÆ';
                document.getElementById(`${period}-chart`).innerHTML = '<div>ÊöÇÊó†Êï∞ÊçÆ</div>';
            });
            document.getElementById('overall-days').textContent = '0';
            document.getElementById('overall-achievement').textContent = '0%';
        }
        
        // ËÆ°ÁÆóÊåáÂÆöÊó∂Èó¥ÊÆµÁöÑÁªüËÆ°Êï∞ÊçÆ
        function calculatePeriodStats(data, prefix, startDate, endDate) {
            if (data.length === 0) {
                document.getElementById(`${prefix}-avg-score`).textContent = '0';
                document.getElementById(`${prefix}-strongest`).textContent = '--';
                document.getElementById(`${prefix}-weakest`).textContent = '--';
                document.getElementById(`${prefix}-avg-time`).textContent = '0';
                document.getElementById(`${prefix}-period`).textContent = `${startDate} Ëá≥ ${endDate}`;
                document.getElementById(`${prefix}-errors`).textContent = 'ÊöÇÊó†Êï∞ÊçÆ';
                document.getElementById(`${prefix}-chart`).innerHTML = '<div>ÊöÇÊó†Êï∞ÊçÆ</div>';
                return;
            }
            
            // ËÆæÁΩÆÊó∂Èó¥ÊÆµ
            document.getElementById(`${prefix}-period`).textContent = `${startDate} Ëá≥ ${endDate}`;
            
            // ËÆ°ÁÆóÂπ≥ÂùáÂàÜ
            let totalScore = 0;
            data.forEach(item => {
                const dailyScore = parseInt(item.vocabScore || 0) + 
                                  parseInt(item.listeningScore || 0) + 
                                  parseInt(item.readingScore || 0) + 
                                  parseInt(item.writingScore || 0) + 
                                  parseInt(item.externalScore || 0);
                totalScore += dailyScore;
            });
            
            const avgScore = Math.round(totalScore / data.length);
            document.getElementById(`${prefix}-avg-score`).textContent = avgScore;
            
            // ËÆ°ÁÆóÂêÑÊäÄËÉΩÂπ≥ÂùáÂàÜ‰ª•Á°ÆÂÆöÊúÄÂº∫ÂíåÊúÄÂº±È°π
            let vocabTotal = 0, listeningTotal = 0, readingTotal = 0, writingTotal = 0, externalTotal = 0;
            let studyTimeTotal = 0;
            const errorTypes = {};
            
            data.forEach(item => {
                vocabTotal += parseInt(item.vocabScore || 0);
                listeningTotal += parseInt(item.listeningScore || 0);
                readingTotal += parseInt(item.readingScore || 0);
                writingTotal += parseInt(item.writingScore || 0);
                externalTotal += parseInt(item.externalScore || 0);
                studyTimeTotal += parseInt(item.studyTime || 0);
                
                // ÁªüËÆ°ÈîôËØØÁ±ªÂûã
                if (item.errorType) {
                    errorTypes[item.errorType] = (errorTypes[item.errorType] || 0) + 1;
                }
            });
            
            const count = data.length;
            const avgVocab = Math.round(vocabTotal / count);
            const avgListening = Math.round(listeningTotal / count);
            const avgReading = Math.round(readingTotal / count);
            const avgWriting = Math.round(writingTotal / count);
            
            const skills = [
                { name: "ËØçÊ±á", score: avgVocab },
                { name: "Âê¨Âäõ", score: avgListening },
                { name: "ÈòÖËØª", score: avgReading },
                { name: "ÂÜô‰Ωú", score: avgWriting }
            ];
            
            // ÊéíÂ∫èÊâæÂá∫ÊúÄÂº∫ÂíåÊúÄÂº±È°π
            skills.sort((a, b) => b.score - a.score);
            document.getElementById(`${prefix}-strongest`).textContent = `${skills[0].name} (${skills[0].score})`;
            document.getElementById(`${prefix}-weakest`).textContent = `${skills[skills.length - 1].name} (${skills[skills.length - 1].score})`;
            
            // Âπ≥ÂùáÂ≠¶‰π†Êó∂Èó¥
            const avgStudyTime = Math.round(studyTimeTotal / count);
            document.getElementById(`${prefix}-avg-time`).textContent = avgStudyTime;
            
            // ÈîôËØØÁ±ªÂûãÂàÜÊûê
            if (Object.keys(errorTypes).length > 0) {
                let errorText = "";
                const sortedErrors = Object.entries(errorTypes).sort((a, b) => b[1] - a[1]);
                
                sortedErrors.forEach(([type, count], index) => {
                    let typeText = "";
                    switch(type) {
                        case "vocabulary": typeText = "ËØçÊ±á‰∏çË∂≥"; break;
                        case "grammar": typeText = "ËØ≠Ê≥ïÈîôËØØ"; break;
                        case "comprehension": typeText = "ÁêÜËß£ÂÅèÂ∑Æ"; break;
                        case "time": typeText = "Êó∂Èó¥‰∏çË∂≥"; break;
                        case "focus": typeText = "Ê≥®ÊÑèÂäõ‰∏çÈõÜ‰∏≠"; break;
                    }
                    
                    errorText += `${typeText}: ${count}Ê¨°`;
                    if (index < sortedErrors.length - 1) errorText += "Ôºå";
                });
                
                document.getElementById(`${prefix}-errors`).textContent = errorText;
            } else {
                document.getElementById(`${prefix}-errors`).textContent = "Êú™ËÆ∞ÂΩïÈîôËØØÁ±ªÂûã";
            }
            
            // ÁîüÊàêÂõæË°®
            generateScoreChart(data, `${prefix}-chart`);
        }
        
        // ÁîüÊàêÂàÜÊï∞ÂõæË°®
        function generateScoreChart(data, chartId) {
            const chartContainer = document.getElementById(chartId);
            chartContainer.innerHTML = '';
            
            // ÊåâÊó•ÊúüÊéíÂ∫è
            const sortedData = [...data].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // ËÆ°ÁÆóÊúÄÈ´òÂàÜÁî®‰∫éÊØî‰æãÁº©Êîæ
            let maxScore = 0;
            sortedData.forEach(item => {
                const score = parseInt(item.vocabScore || 0) + 
                             parseInt(item.listeningScore || 0) + 
                             parseInt(item.readingScore || 0) + 
                             parseInt(item.writingScore || 0) + 
                             parseInt(item.externalScore || 0);
                if (score > maxScore) maxScore = score;
            });
            
            // Á°Æ‰øùÊúâ‰∏Ä‰∏™ÂêàÁêÜÁöÑÊúÄÂ§ßÂÄº
            maxScore = Math.max(maxScore, 100);
            
            // ÂàõÂª∫Êü±Áä∂Âõæ
            sortedData.forEach(item => {
                const score = parseInt(item.vocabScore || 0) + 
                             parseInt(item.listeningScore || 0) + 
                             parseInt(item.readingScore || 0) + 
                             parseInt(item.writingScore || 0) + 
                             parseInt(item.externalScore || 0);
                
                // ËÆ°ÁÆóÈ´òÂ∫¶ÊØî‰æã (ÊúÄÈ´òÂàÜ‰∏∫100%È´òÂ∫¶)
                const height = (score / maxScore) * 100;
                
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${height}%`;
                bar.style.bottom = '0';
                
                // Ê∑ªÂä†ÂàÜÊï∞Ê†áÁ≠æ
                const scoreLabel = document.createElement('div');
                scoreLabel.style.position = 'absolute';
                scoreLabel.style.top = '-20px';
                scoreLabel.style.left = '50%';
                scoreLabel.style.transform = 'translateX(-50%)';
                scoreLabel.style.fontSize = '12px';
                scoreLabel.textContent = score;
                bar.appendChild(scoreLabel);
                
                // Ê∑ªÂä†Êó•ÊúüÊ†áÁ≠æ
                const dateLabel = document.createElement('div');
                dateLabel.className = 'chart-label';
                // Âè™ÊòæÁ§∫Êúà/Êó•
                const date = new Date(item.date);
                dateLabel.textContent = `${date.getMonth() + 1}/${date.getDate()}`;
                bar.appendChild(dateLabel);
                
                chartContainer.appendChild(bar);
            });
        }
        
        function updateAvailableRewards() {
            const rewardsElement = document.getElementById('available-rewards');
            if (totalPoints >= 80) {
                rewardsElement.innerHTML = '<span style="color:green;">‚úì ÊÅ≠ÂñúÔºÅÊÇ®Â∑≤Ëé∑Âæó‰ªäÊó•Â•ñÂä±Ôºö30ÂàÜÈíüÊó†Ë¥üÁΩ™ÊÑüÂ®±‰πêÊó∂Èó¥</span>';
            } else {
                rewardsElement.textContent = `ËøòÈúÄ${80 - totalPoints}ÂàÜÊâçËÉΩËß£ÈîÅ‰ªäÊó•Â•ñÂä±`;
            }
        }
        
        function claimReward() {
            if (totalPoints >= 80) {
                alert('Â•ñÂä±Â∑≤È¢ÜÂèñÔºÅ‰∫´ÂèóÊÇ®ÁöÑ30ÂàÜÈíüÂ®±‰πêÊó∂Èó¥ÂêßÔºÅ');
            } else {
                alert(`Â∞öÊú™ËææÂà∞ÂÖëÊç¢Ë¶ÅÊ±ÇÔºåËøòÈúÄ${80 - totalPoints}ÂàÜ`);
            }
        }
        
        // Ê∑ªÂä†Ëß¶Êë∏‰∫ã‰ª∂ÊîØÊåÅ
        document.querySelectorAll('.nav-tab, .btn, .checkbox, .stats-tab').forEach(element => {
            element.addEventListener('touchstart', function() {
                this.style.opacity = '0.7';
            });
            
            element.addEventListener('touchend', function() {
                this.style.opacity = '1';
            });
        });
        
        // Èò≤Ê≠¢iOSÁº©Êîæ
        document.addEventListener('touchstart', function(event) {
            if (event.touches.length > 1) {
                event.preventDefault();
            }
        }, { passive: false });
        
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>